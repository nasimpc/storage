<html>

<body id="a">
    <h1>Form</h1>
    <form onsubmit="saveToLocalStorage(event)">
        <label> Name</label>
        <input id="name" type="text" name="username" required />
        <label> EmailId</label>
        <input id="email" type="email" name="emailId" required />
        <label> Phone Number</label>
        <input id="phno" type="tel" name="phonenumber" />
        <button> Submit </button><br>

    </form>
    <p id="b"></p>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.0/axios.min.js"></script>
    <script>
        var body = document.getElementById('a');
        body.addEventListener('click', removeItem);
        function saveToLocalStorage(e) {
            e.preventDefault();
            const name = event.target.username.value;
            const email = event.target.emailId.value;
            const phonenumber = event.target.phonenumber.value;
            //localStorage.setItem('name', name);
            //localStorage.setItem('email', email);
            //localStorage.setItem('phonenumber', phonenumber);
            var newText = document.createTextNode(name + ' ' + email + ' ' + phonenumber + ' ');

            // Add text to div
            var a = document.querySelector('#a');
            var b = document.querySelector('#b');
            linebreak = document.createElement("br");
            var div = document.createElement('div');
            div.appendChild(newText);
            //a.insertBefore(newText, b);
            //delete btn
            var deleteBtn = document.createElement('button');
            var editBtn = document.createElement('button');
            deleteBtn.className = 'btn btn-sm float-right delete';
            editBtn.className = 'btn btn-sm float-right';
            deleteBtn.appendChild(document.createTextNode('X'));
            editBtn.appendChild(document.createTextNode('Edit'));
            //a.insertBefore(deleteBtn, b);
            div.appendChild(editBtn);
            div.appendChild(deleteBtn);
            //a.insertBefore(linebreak, b);
            div.appendChild(linebreak);
            a.insertBefore(div, b);


            const obj = {
                name: name,
                email: email,
                phonenumber: phonenumber
            }
            axios.post("https://crudcrud.com/api/5de19888f54c4a5a9765d1627b28a222/data", obj).then(res => { console.log(res) }).catch(err => { console.log(err) });
            //localStorage.setItem(phonenumber, JSON.stringify(obj));
        }
        // Remove item
        function removeItem(e) {
            if (e.target.classList.contains('delete')) {
                if (confirm('Are You Sure?')) {
                    var div = e.target.parentElement;
                    body.removeChild(div);
                    console.log(div);
                    var words = div.firstChild.wholeText;

                    var n = words.split(" ");
                    //console.log(n[n.length - 2]);
                    localStorage.removeItem(n[n.length - 2]);
                }
            }
            else if (e.target.classList.contains('btn-sm')) {
                var div = e.target.parentElement;
                body.removeChild(div);
                console.log(div);
                var words = div.firstChild.wholeText;

                var n = words.split(" ");
                //console.log(n[n.length - 2]);
                localStorage.removeItem(n[n.length - 2]);
                var name = document.getElementById('name');
                name.value = n[0];
                var email = document.getElementById('email');
                email.value = n[1];
                var phno = document.getElementById('phno');
                phno.value = n[2];


            }

        }

    </script>
</body>

</html>